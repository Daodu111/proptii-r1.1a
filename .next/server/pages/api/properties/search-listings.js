"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/properties/search-listings";
exports.ids = ["pages/api/properties/search-listings"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproperties%2Fsearch-listings&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fproperties%2Fsearch-listings.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproperties%2Fsearch-listings&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fproperties%2Fsearch-listings.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_properties_search_listings_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/properties/search-listings.ts */ \"(api-node)/./src/pages/api/properties/search-listings.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_properties_search_listings_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_properties_search_listings_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_properties_search_listings_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_properties_search_listings_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/properties/search-listings\",\n        pathname: \"/api/properties/search-listings\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_properties_search_listings_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGcHJvcGVydGllcyUyRnNlYXJjaC1saXN0aW5ncyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGcHJvcGVydGllcyUyRnNlYXJjaC1saXN0aW5ncy50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDRTtBQUMxRDtBQUMwRTtBQUMxRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMseUVBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHlFQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLHlHQUFtQjtBQUNsRDtBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjL3BhZ2VzL2FwaS9wcm9wZXJ0aWVzL3NlYXJjaC1saXN0aW5ncy50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcHJvcGVydGllcy9zZWFyY2gtbGlzdGluZ3NcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9wcm9wZXJ0aWVzL3NlYXJjaC1saXN0aW5nc1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproperties%2Fsearch-listings&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fproperties%2Fsearch-listings.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/properties/search-listings.ts":
/*!*****************************************************!*\
  !*** ./src/pages/api/properties/search-listings.ts ***!
  \*****************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cheerio */ \"cheerio\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([cheerio__WEBPACK_IMPORTED_MODULE_0__]);\ncheerio__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nconst RIGHTMOVE_SEARCH_URL_PATTERN = /^https?:\\/\\/(www\\.)?rightmove\\.co\\.uk\\/(property-for-sale|property-to-rent|properties|find).*$/;\nconst ZOOPLA_SEARCH_URL_PATTERN = /^https?:\\/\\/(www\\.)?zoopla\\.co\\.uk\\/(for-sale|to-rent)\\/.*$/;\nconst OPENRENT_SEARCH_URL_PATTERN = /^https?:\\/\\/(www\\.)?openrent\\.co\\.uk\\/properties-to-rent\\/.*$/;\nconst PARSERS = {\n    rightmove: {\n        selector: '[data-test=\"propertyCard\"]',\n        baseUrl: 'https://www.rightmove.co.uk',\n        extract: ($, element)=>{\n            const $element = $(element);\n            const price = $element.find('[data-test=\"propertyPrice\"]').text().trim();\n            const title = $element.find('[data-test=\"propertyTitle\"]').text().trim();\n            const location = $element.find('[data-test=\"propertySubtitle\"]').text().trim();\n            const image = $element.find('img[data-test=\"propertyImage\"]').attr('src') || '';\n            const propertyUrl = $element.find('a[data-test=\"propertyCard-link\"]').attr('href');\n            if (!price || !title) return null;\n            // Extract specs from the property features\n            const specs = {\n                beds: parseInt($element.find('[data-test=\"propertyBedrooms\"]').text()) || 0,\n                baths: parseInt($element.find('[data-test=\"propertyBathrooms\"]').text()) || 0,\n                area: $element.find('[data-test=\"propertyFloorArea\"]').text().trim() || 'N/A'\n            };\n            return {\n                id: `rm-${Date.now()}-${Math.random()}`,\n                price,\n                title,\n                location,\n                image: image.startsWith('http') ? image : `${PARSERS.rightmove.baseUrl}${image}`,\n                specs,\n                propertyUrl: propertyUrl ? `${PARSERS.rightmove.baseUrl}${propertyUrl}` : undefined\n            };\n        }\n    },\n    zoopla: {\n        selector: '[data-testid=\"regular-listing\"]',\n        baseUrl: 'https://www.zoopla.co.uk',\n        extract: ($, element)=>{\n            const $element = $(element);\n            const price = $element.find('[data-testid=\"listing-price\"]').text().trim();\n            const title = $element.find('[data-testid=\"listing-title\"]').text().trim();\n            const location = $element.find('[data-testid=\"listing-location\"]').text().trim();\n            const image = $element.find('img').first().attr('src') || '';\n            const propertyUrl = $element.find('a').first().attr('href');\n            if (!price || !title) return null;\n            // Extract specs from the listing details\n            const specs = {\n                beds: parseInt($element.find('[data-testid=\"listing-spec-beds\"] span').first().text()) || 0,\n                baths: parseInt($element.find('[data-testid=\"listing-spec-baths\"] span').first().text()) || 0,\n                area: $element.find('[data-testid=\"listing-spec-floorArea\"] span').first().text().trim() || 'N/A'\n            };\n            return {\n                id: `zp-${Date.now()}-${Math.random()}`,\n                price,\n                title,\n                location,\n                image: image.startsWith('http') ? image : `${PARSERS.zoopla.baseUrl}${image}`,\n                specs,\n                propertyUrl: propertyUrl ? `${PARSERS.zoopla.baseUrl}${propertyUrl}` : undefined\n            };\n        }\n    },\n    openrent: {\n        selector: '.property-box',\n        baseUrl: 'https://www.openrent.co.uk',\n        extract: ($, element)=>{\n            const $element = $(element);\n            const titleElement = $element.find('.banda a');\n            const price = $element.find('.price').text().trim().split('per')[0].trim();\n            const title = titleElement.text().trim();\n            const location = $element.find('.location').text().trim();\n            const image = $element.find('.mainImage').attr('src') || '';\n            const propertyUrl = titleElement.attr('href');\n            if (!price || !title) return null;\n            // Extract specs from the description\n            const description = $element.find('.description').text().trim();\n            const bedsMatch = description.match(/(\\d+)\\s*(?:double\\s*)?bed/i);\n            const bathsMatch = description.match(/(\\d+)\\s*bath/i);\n            const specs = {\n                beds: bedsMatch ? parseInt(bedsMatch[1]) : 0,\n                baths: bathsMatch ? parseInt(bathsMatch[1]) : 0,\n                area: 'N/A' // OpenRent typically doesn't show area in search results\n            };\n            return {\n                id: `or-${Date.now()}-${Math.random()}`,\n                price,\n                title,\n                location,\n                image: image.startsWith('http') ? image : `${PARSERS.openrent.baseUrl}${image}`,\n                specs,\n                propertyUrl: propertyUrl ? `${PARSERS.openrent.baseUrl}${propertyUrl}` : undefined\n            };\n        }\n    }\n};\nasync function handler(req, res) {\n    // Enable CORS\n    res.setHeader('Access-Control-Allow-Credentials', 'true');\n    res.setHeader('Access-Control-Allow-Origin', '*');\n    res.setHeader('Access-Control-Allow-Methods', 'GET,OPTIONS,PATCH,DELETE,POST,PUT');\n    res.setHeader('Access-Control-Allow-Headers', 'X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version');\n    if (req.method === 'OPTIONS') {\n        res.status(200).end();\n        return;\n    }\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            message: 'Method not allowed'\n        });\n    }\n    try {\n        const { searchUrl } = req.body;\n        console.log('Received search URL:', searchUrl);\n        if (!searchUrl) {\n            return res.status(400).json({\n                message: 'Search URL is required'\n            });\n        }\n        // Validate URL format\n        try {\n            new URL(searchUrl);\n        } catch (error) {\n            return res.status(400).json({\n                message: 'Invalid URL format'\n            });\n        }\n        // Determine which parser to use\n        let parser;\n        let parserName = '';\n        if (RIGHTMOVE_SEARCH_URL_PATTERN.test(searchUrl)) {\n            parser = PARSERS.rightmove;\n            parserName = 'rightmove';\n        } else if (ZOOPLA_SEARCH_URL_PATTERN.test(searchUrl)) {\n            parser = PARSERS.zoopla;\n            parserName = 'zoopla';\n        } else if (OPENRENT_SEARCH_URL_PATTERN.test(searchUrl)) {\n            parser = PARSERS.openrent;\n            parserName = 'openrent';\n        }\n        if (!parser) {\n            console.log('URL pattern matching results:', {\n                rightmove: RIGHTMOVE_SEARCH_URL_PATTERN.test(searchUrl),\n                zoopla: ZOOPLA_SEARCH_URL_PATTERN.test(searchUrl),\n                openrent: OPENRENT_SEARCH_URL_PATTERN.test(searchUrl)\n            });\n            return res.status(400).json({\n                message: 'Invalid property search URL format. Only Rightmove, Zoopla, and OpenRent URLs are supported.'\n            });\n        }\n        console.log(`Using ${parserName} parser for URL:`, searchUrl);\n        const headers = {\n            'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36',\n            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8',\n            'Accept-Language': 'en-GB,en-US;q=0.9,en;q=0.8',\n            'Accept-Encoding': 'gzip, deflate, br',\n            'Cache-Control': 'no-cache',\n            'Pragma': 'no-cache',\n            'Sec-Ch-Ua': '\"Chromium\";v=\"122\", \"Not(A:Brand\";v=\"24\", \"Google Chrome\";v=\"122\"',\n            'Sec-Ch-Ua-Mobile': '?0',\n            'Sec-Ch-Ua-Platform': '\"macOS\"',\n            'Sec-Fetch-Dest': 'document',\n            'Sec-Fetch-Mode': 'navigate',\n            'Sec-Fetch-Site': 'none',\n            'Sec-Fetch-User': '?1',\n            'Upgrade-Insecure-Requests': '1',\n            'Connection': 'keep-alive'\n        };\n        // Add site-specific headers\n        if (parserName === 'rightmove') {\n            headers['Referer'] = 'https://www.rightmove.co.uk/';\n        } else if (parserName === 'zoopla') {\n            headers['Referer'] = 'https://www.zoopla.co.uk/';\n        } else if (parserName === 'openrent') {\n            headers['Referer'] = 'https://www.openrent.co.uk/';\n        }\n        const response = await fetch(searchUrl, {\n            headers\n        });\n        console.log('Fetch response status:', response.status);\n        console.log('Fetch response headers:', response.headers);\n        if (!response.ok) {\n            if (response.status === 403) {\n                console.error('Access forbidden - possible bot detection');\n                return res.status(403).json({\n                    message: 'Unable to access the property site. This might be due to rate limiting or bot detection.'\n                });\n            }\n            if (response.status === 404) {\n                console.error('Page not found');\n                return res.status(404).json({\n                    message: 'The property listing page could not be found. The URL might be invalid or the listing may have been removed.'\n                });\n            }\n            console.error('Failed to fetch:', response.status, response.statusText);\n            throw new Error(`Failed to fetch search results: ${response.status} ${response.statusText}`);\n        }\n        const html = await response.text();\n        console.log('HTML received, length:', html.length);\n        if (html.length < 1000) {\n            console.warn('Suspiciously short HTML response:', html);\n            return res.status(403).json({\n                message: 'Received an invalid response from the property site. This might be due to rate limiting or bot detection.'\n            });\n        }\n        console.log('First 500 chars of HTML:', html.substring(0, 500));\n        const $ = cheerio__WEBPACK_IMPORTED_MODULE_0__.load(html);\n        const properties = [];\n        // Get first 3 regular listings\n        const listings = $(parser.selector);\n        console.log(`Found ${listings.length} listings with selector \"${parser.selector}\"`);\n        if (listings.length === 0) {\n            // Log a sample of the HTML structure to help debug selector issues\n            console.log('HTML structure sample:');\n            $('body').children().slice(0, 3).each((_, el)=>{\n                console.log($(el).prop('tagName'), $(el).attr('class') || 'no-class');\n            });\n            return res.status(404).json({\n                message: 'No property listings found'\n            });\n        }\n        listings.each((index, element)=>{\n            try {\n                const property = parser.extract($, element);\n                if (property) {\n                    console.log(`Successfully extracted property ${index + 1}:`, {\n                        title: property.title,\n                        price: property.price,\n                        location: property.location,\n                        specs: property.specs\n                    });\n                    properties.push(property);\n                } else {\n                    console.log(`Failed to extract property ${index + 1} - missing required fields`);\n                }\n            } catch (error) {\n                console.error(`Error extracting property ${index + 1}:`, error);\n            }\n            if (properties.length >= 3) return false;\n        });\n        if (properties.length === 0) {\n            console.log('No valid properties found');\n            return res.status(404).json({\n                message: 'No valid property data could be extracted'\n            });\n        }\n        console.log('Returning properties:', properties.length);\n        res.status(200).json(properties);\n    } catch (error) {\n        console.error('Error processing property search:', error);\n        res.status(500).json({\n            message: 'Error processing property search',\n            error: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvcHJvcGVydGllcy9zZWFyY2gtbGlzdGluZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFDbUM7QUFHbkMsTUFBTUMsK0JBQStCO0FBQ3JDLE1BQU1DLDRCQUE0QjtBQUNsQyxNQUFNQyw4QkFBOEI7QUFRcEMsTUFBTUMsVUFBMEM7SUFDOUNDLFdBQVc7UUFDVEMsVUFBVTtRQUNWQyxTQUFTO1FBQ1RDLFNBQVMsQ0FBQ0MsR0FBb0NDO1lBQzVDLE1BQU1DLFdBQVdGLEVBQUVDO1lBQ25CLE1BQU1FLFFBQVFELFNBQVNFLElBQUksQ0FBQywrQkFBK0JDLElBQUksR0FBR0MsSUFBSTtZQUN0RSxNQUFNQyxRQUFRTCxTQUFTRSxJQUFJLENBQUMsK0JBQStCQyxJQUFJLEdBQUdDLElBQUk7WUFDdEUsTUFBTUUsV0FBV04sU0FBU0UsSUFBSSxDQUFDLGtDQUFrQ0MsSUFBSSxHQUFHQyxJQUFJO1lBQzVFLE1BQU1HLFFBQVFQLFNBQVNFLElBQUksQ0FBQyxrQ0FBa0NNLElBQUksQ0FBQyxVQUFVO1lBQzdFLE1BQU1DLGNBQWNULFNBQVNFLElBQUksQ0FBQyxvQ0FBb0NNLElBQUksQ0FBQztZQUUzRSxJQUFJLENBQUNQLFNBQVMsQ0FBQ0ksT0FBTyxPQUFPO1lBRTdCLDJDQUEyQztZQUMzQyxNQUFNSyxRQUFRO2dCQUNaQyxNQUFNQyxTQUFTWixTQUFTRSxJQUFJLENBQUMsa0NBQWtDQyxJQUFJLE9BQU87Z0JBQzFFVSxPQUFPRCxTQUFTWixTQUFTRSxJQUFJLENBQUMsbUNBQW1DQyxJQUFJLE9BQU87Z0JBQzVFVyxNQUFNZCxTQUFTRSxJQUFJLENBQUMsbUNBQW1DQyxJQUFJLEdBQUdDLElBQUksTUFBTTtZQUMxRTtZQUVBLE9BQU87Z0JBQ0xXLElBQUksQ0FBQyxHQUFHLEVBQUVDLEtBQUtDLEdBQUcsR0FBRyxDQUFDLEVBQUVDLEtBQUtDLE1BQU0sSUFBSTtnQkFDdkNsQjtnQkFDQUk7Z0JBQ0FDO2dCQUNBQyxPQUFP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UUFBUSxFQUFFLDBCQUEwQixDQUFDO2dCQUNqRjtZQUNGLEVBQUUsT0FBT3ZCLE9BQU87Z0JBQ2RILFFBQVFHLEtBQUssQ0FBQyxDQUFDLDBCQUEwQixFQUFFdUIsUUFBUSxFQUFFLENBQUMsQ0FBQyxFQUFFdkI7WUFDM0Q7WUFDQSxJQUFJZSxXQUFXSixNQUFNLElBQUksR0FBRyxPQUFPO1FBQ3JDO1FBRUEsSUFBSUksV0FBV0osTUFBTSxLQUFLLEdBQUc7WUFDM0JkLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU9WLElBQUlHLE1BQU0sQ0FBQyxLQUFLRSxJQUFJLENBQUM7Z0JBQUVDLFNBQVM7WUFBNEM7UUFDckY7UUFFQUcsUUFBUUMsR0FBRyxDQUFDLHlCQUF5QmlCLFdBQVdKLE1BQU07UUFDdER2QixJQUFJRyxNQUFNLENBQUMsS0FBS0UsSUFBSSxDQUFDc0I7SUFDdkIsRUFBRSxPQUFPZixPQUFPO1FBQ2RILFFBQVFHLEtBQUssQ0FBQyxxQ0FBcUNBO1FBQ25EWixJQUFJRyxNQUFNLENBQUMsS0FBS0UsSUFBSSxDQUFDO1lBQ25CQyxTQUFTO1lBQ1RNLE9BQU8sTUFBaUJOLE9BQU87UUFDakM7SUFDRjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvdG9zaW5sYW5pcGVrdW4vRG9jdW1lbnRzL0NhcnBlIERpZW0vV29yay8wMSBMdXhjaXR5LzAxIERpZ2l0YWwgYW5kIEFJIFNvbHV0aW9ucy8wMyBQcm9kdWN0LzAwIFByb3B0aWkvMDMgQXBwLzAxIEFwcCBSZWxlYXNlIFZlcnNpb25zL1Byb3B0aWlfTVZQX3IxLjEvMDMgQm9sdCBhbmQgQ3Vyc29yIEJ1aWxkLzAyIFByb3B0aWkgcHJvamVjdC9zcmMvcGFnZXMvYXBpL3Byb3BlcnRpZXMvc2VhcmNoLWxpc3RpbmdzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCAqIGFzIGNoZWVyaW8gZnJvbSAnY2hlZXJpbyc7XG5pbXBvcnQgeyBQcm9wZXJ0eSB9IGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvdmlld2luZ3MvY29udGV4dC9Cb29rVmlld2luZ0NvbnRleHQnO1xuXG5jb25zdCBSSUdIVE1PVkVfU0VBUkNIX1VSTF9QQVRURVJOID0gL15odHRwcz86XFwvXFwvKHd3d1xcLik/cmlnaHRtb3ZlXFwuY29cXC51a1xcLyhwcm9wZXJ0eS1mb3Itc2FsZXxwcm9wZXJ0eS10by1yZW50fHByb3BlcnRpZXN8ZmluZCkuKiQvO1xuY29uc3QgWk9PUExBX1NFQVJDSF9VUkxfUEFUVEVSTiA9IC9eaHR0cHM/OlxcL1xcLyh3d3dcXC4pP3pvb3BsYVxcLmNvXFwudWtcXC8oZm9yLXNhbGV8dG8tcmVudClcXC8uKiQvO1xuY29uc3QgT1BFTlJFTlRfU0VBUkNIX1VSTF9QQVRURVJOID0gL15odHRwcz86XFwvXFwvKHd3d1xcLik/b3BlbnJlbnRcXC5jb1xcLnVrXFwvcHJvcGVydGllcy10by1yZW50XFwvLiokLztcblxuaW50ZXJmYWNlIFByb3BlcnR5UGFyc2VyIHtcbiAgc2VsZWN0b3I6IHN0cmluZztcbiAgZXh0cmFjdDogKCQ6IFJldHVyblR5cGU8dHlwZW9mIGNoZWVyaW8ubG9hZD4sIGVsZW1lbnQ6IGNoZWVyaW8uRWxlbWVudCkgPT4gUHJvcGVydHkgfCBudWxsO1xuICBiYXNlVXJsOiBzdHJpbmc7XG59XG5cbmNvbnN0IFBBUlNFUlM6IFJlY29yZDxzdHJpbmcsIFByb3BlcnR5UGFyc2VyPiA9IHtcbiAgcmlnaHRtb3ZlOiB7XG4gICAgc2VsZWN0b3I6ICdbZGF0YS10ZXN0PVwicHJvcGVydHlDYXJkXCJdJyxcbiAgICBiYXNlVXJsOiAnaHR0cHM6Ly93d3cucmlnaHRtb3ZlLmNvLnVrJyxcbiAgICBleHRyYWN0OiAoJDogUmV0dXJuVHlwZTx0eXBlb2YgY2hlZXJpby5sb2FkPiwgZWxlbWVudDogY2hlZXJpby5FbGVtZW50KTogUHJvcGVydHkgfCBudWxsID0+IHtcbiAgICAgIGNvbnN0ICRlbGVtZW50ID0gJChlbGVtZW50KTtcbiAgICAgIGNvbnN0IHByaWNlID0gJGVsZW1lbnQuZmluZCgnW2RhdGEtdGVzdD1cInByb3BlcnR5UHJpY2VcIl0nKS50ZXh0KCkudHJpbSgpO1xuICAgICAgY29uc3QgdGl0bGUgPSAkZWxlbWVudC5maW5kKCdbZGF0YS10ZXN0PVwicHJvcGVydHlUaXRsZVwiXScpLnRleHQoKS50cmltKCk7XG4gICAgICBjb25zdCBsb2NhdGlvbiA9ICRlbGVtZW50LmZpbmQoJ1tkYXRhLXRlc3Q9XCJwcm9wZXJ0eVN1YnRpdGxlXCJdJykudGV4dCgpLnRyaW0oKTtcbiAgICAgIGNvbnN0IGltYWdlID0gJGVsZW1lbnQuZmluZCgnaW1nW2RhdGEtdGVzdD1cInByb3BlcnR5SW1hZ2VcIl0nKS5hdHRyKCdzcmMnKSB8fCAnJztcbiAgICAgIGNvbnN0IHByb3BlcnR5VXJsID0gJGVsZW1lbnQuZmluZCgnYVtkYXRhLXRlc3Q9XCJwcm9wZXJ0eUNhcmQtbGlua1wiXScpLmF0dHIoJ2hyZWYnKTtcbiAgICAgIFxuICAgICAgaWYgKCFwcmljZSB8fCAhdGl0bGUpIHJldHVybiBudWxsO1xuXG4gICAgICAvLyBFeHRyYWN0IHNwZWNzIGZyb20gdGhlIHByb3BlcnR5IGZlYXR1cmVzXG4gICAgICBjb25zdCBzcGVjcyA9IHtcbiAgICAgICAgYmVkczogcGFyc2VJbnQoJGVsZW1lbnQuZmluZCgnW2RhdGEtdGVzdD1cInByb3BlcnR5QmVkcm9vbXNcIl0nKS50ZXh0KCkpIHx8IDAsXG4gICAgICAgIGJhdGhzOiBwYXJzZUludCgkZWxlbWVudC5maW5kKCdbZGF0YS10ZXN0PVwicHJvcGVydHlCYXRocm9vbXNcIl0nKS50ZXh0KCkpIHx8IDAsXG4gICAgICAgIGFyZWE6ICRlbGVtZW50LmZpbmQoJ1tkYXRhLXRlc3Q9XCJwcm9wZXJ0eUZsb29yQXJlYVwiXScpLnRleHQoKS50cmltKCkgfHwgJ04vQSdcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBgcm0tJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCl9YCxcbiAgICAgICAgcHJpY2UsXG4gICAgICAgIHRpdGxlLFxuICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgaW1hZ2U6IGltYWdlLnN0YXJ0c1dpdGgoJ2h0dHAnKSA/IGltYWdlIDogYCR7UEFSU0VSUy5yaWdodG1vdmUuYmFzZVVybH0ke2ltYWdlfWAsXG4gICAgICAgIHNwZWNzLFxuICAgICAgICBwcm9wZXJ0eVVybDogcHJvcGVydHlVcmwgPyBgJHtQQVJTRVJTLnJpZ2h0bW92ZS5iYXNlVXJsfSR7cHJvcGVydHlVcmx9YCA6IHVuZGVmaW5lZFxuICAgICAgfTtcbiAgICB9XG4gIH0sXG4gIHpvb3BsYToge1xuICAgIHNlbGVjdG9yOiAnW2RhdGEtdGVzdGlkPVwicmVndWxhci1saXN0aW5nXCJdJyxcbiAgICBiYXNlVXJsOiAnaHR0cHM6Ly93d3cuem9vcGxhLmNvLnVrJyxcbiAgICBleHRyYWN0OiAoJDogUmV0dXJuVHlwZTx0eXBlb2YgY2hlZXJpby5sb2FkPiwgZWxlbWVudDogY2hlZXJpby5FbGVtZW50KTogUHJvcGVydHkgfCBudWxsID0+IHtcbiAgICAgIGNvbnN0ICRlbGVtZW50ID0gJChlbGVtZW50KTtcbiAgICAgIGNvbnN0IHByaWNlID0gJGVsZW1lbnQuZmluZCgnW2RhdGEtdGVzdGlkPVwibGlzdGluZy1wcmljZVwiXScpLnRleHQoKS50cmltKCk7XG4gICAgICBjb25zdCB0aXRsZSA9ICRlbGVtZW50LmZpbmQoJ1tkYXRhLXRlc3RpZD1cImxpc3RpbmctdGl0bGVcIl0nKS50ZXh0KCkudHJpbSgpO1xuICAgICAgY29uc3QgbG9jYXRpb24gPSAkZWxlbWVudC5maW5kKCdbZGF0YS10ZXN0aWQ9XCJsaXN0aW5nLWxvY2F0aW9uXCJdJykudGV4dCgpLnRyaW0oKTtcbiAgICAgIGNvbnN0IGltYWdlID0gJGVsZW1lbnQuZmluZCgnaW1nJykuZmlyc3QoKS5hdHRyKCdzcmMnKSB8fCAnJztcbiAgICAgIGNvbnN0IHByb3BlcnR5VXJsID0gJGVsZW1lbnQuZmluZCgnYScpLmZpcnN0KCkuYXR0cignaHJlZicpO1xuICAgICAgXG4gICAgICBpZiAoIXByaWNlIHx8ICF0aXRsZSkgcmV0dXJuIG51bGw7XG5cbiAgICAgIC8vIEV4dHJhY3Qgc3BlY3MgZnJvbSB0aGUgbGlzdGluZyBkZXRhaWxzXG4gICAgICBjb25zdCBzcGVjcyA9IHtcbiAgICAgICAgYmVkczogcGFyc2VJbnQoJGVsZW1lbnQuZmluZCgnW2RhdGEtdGVzdGlkPVwibGlzdGluZy1zcGVjLWJlZHNcIl0gc3BhbicpLmZpcnN0KCkudGV4dCgpKSB8fCAwLFxuICAgICAgICBiYXRoczogcGFyc2VJbnQoJGVsZW1lbnQuZmluZCgnW2RhdGEtdGVzdGlkPVwibGlzdGluZy1zcGVjLWJhdGhzXCJdIHNwYW4nKS5maXJzdCgpLnRleHQoKSkgfHwgMCxcbiAgICAgICAgYXJlYTogJGVsZW1lbnQuZmluZCgnW2RhdGEtdGVzdGlkPVwibGlzdGluZy1zcGVjLWZsb29yQXJlYVwiXSBzcGFuJykuZmlyc3QoKS50ZXh0KCkudHJpbSgpIHx8ICdOL0EnXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogYHpwLSR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpfWAsXG4gICAgICAgIHByaWNlLFxuICAgICAgICB0aXRsZSxcbiAgICAgICAgbG9jYXRpb24sXG4gICAgICAgIGltYWdlOiBpbWFnZS5zdGFydHNXaXRoKCdodHRwJykgPyBpbWFnZSA6IGAke1BBUlNFUlMuem9vcGxhLmJhc2VVcmx9JHtpbWFnZX1gLFxuICAgICAgICBzcGVjcyxcbiAgICAgICAgcHJvcGVydHlVcmw6IHByb3BlcnR5VXJsID8gYCR7UEFSU0VSUy56b29wbGEuYmFzZVVybH0ke3Byb3BlcnR5VXJsfWAgOiB1bmRlZmluZWRcbiAgICAgIH07XG4gICAgfVxuICB9LFxuICBvcGVucmVudDoge1xuICAgIHNlbGVjdG9yOiAnLnByb3BlcnR5LWJveCcsXG4gICAgYmFzZVVybDogJ2h0dHBzOi8vd3d3Lm9wZW5yZW50LmNvLnVrJyxcbiAgICBleHRyYWN0OiAoJDogUmV0dXJuVHlwZTx0eXBlb2YgY2hlZXJpby5sb2FkPiwgZWxlbWVudDogY2hlZXJpby5FbGVtZW50KTogUHJvcGVydHkgfCBudWxsID0+IHtcbiAgICAgIGNvbnN0ICRlbGVtZW50ID0gJChlbGVtZW50KTtcbiAgICAgIGNvbnN0IHRpdGxlRWxlbWVudCA9ICRlbGVtZW50LmZpbmQoJy5iYW5kYSBhJyk7XG4gICAgICBjb25zdCBwcmljZSA9ICRlbGVtZW50LmZpbmQoJy5wcmljZScpLnRleHQoKS50cmltKCkuc3BsaXQoJ3BlcicpWzBdLnRyaW0oKTtcbiAgICAgIGNvbnN0IHRpdGxlID0gdGl0bGVFbGVtZW50LnRleHQoKS50cmltKCk7XG4gICAgICBjb25zdCBsb2NhdGlvbiA9ICRlbGVtZW50LmZpbmQoJy5sb2NhdGlvbicpLnRleHQoKS50cmltKCk7XG4gICAgICBjb25zdCBpbWFnZSA9ICRlbGVtZW50LmZpbmQoJy5tYWluSW1hZ2UnKS5hdHRyKCdzcmMnKSB8fCAnJztcbiAgICAgIGNvbnN0IHByb3BlcnR5VXJsID0gdGl0bGVFbGVtZW50LmF0dHIoJ2hyZWYnKTtcbiAgICAgIFxuICAgICAgaWYgKCFwcmljZSB8fCAhdGl0bGUpIHJldHVybiBudWxsO1xuXG4gICAgICAvLyBFeHRyYWN0IHNwZWNzIGZyb20gdGhlIGRlc2NyaXB0aW9uXG4gICAgICBjb25zdCBkZXNjcmlwdGlvbiA9ICRlbGVtZW50LmZpbmQoJy5kZXNjcmlwdGlvbicpLnRleHQoKS50cmltKCk7XG4gICAgICBjb25zdCBiZWRzTWF0Y2ggPSBkZXNjcmlwdGlvbi5tYXRjaCgvKFxcZCspXFxzKig/OmRvdWJsZVxccyopP2JlZC9pKTtcbiAgICAgIGNvbnN0IGJhdGhzTWF0Y2ggPSBkZXNjcmlwdGlvbi5tYXRjaCgvKFxcZCspXFxzKmJhdGgvaSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHNwZWNzID0ge1xuICAgICAgICBiZWRzOiBiZWRzTWF0Y2ggPyBwYXJzZUludChiZWRzTWF0Y2hbMV0pIDogMCxcbiAgICAgICAgYmF0aHM6IGJhdGhzTWF0Y2ggPyBwYXJzZUludChiYXRoc01hdGNoWzFdKSA6IDAsXG4gICAgICAgIGFyZWE6ICdOL0EnIC8vIE9wZW5SZW50IHR5cGljYWxseSBkb2Vzbid0IHNob3cgYXJlYSBpbiBzZWFyY2ggcmVzdWx0c1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IGBvci0ke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKX1gLFxuICAgICAgICBwcmljZSxcbiAgICAgICAgdGl0bGUsXG4gICAgICAgIGxvY2F0aW9uLFxuICAgICAgICBpbWFnZTogaW1hZ2Uuc3RhcnRzV2l0aCgnaHR0cCcpID8gaW1hZ2UgOiBgJHtQQVJTRVJTLm9wZW5yZW50LmJhc2VVcmx9JHtpbWFnZX1gLFxuICAgICAgICBzcGVjcyxcbiAgICAgICAgcHJvcGVydHlVcmw6IHByb3BlcnR5VXJsID8gYCR7UEFSU0VSUy5vcGVucmVudC5iYXNlVXJsfSR7cHJvcGVydHlVcmx9YCA6IHVuZGVmaW5lZFxuICAgICAgfTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgLy8gRW5hYmxlIENPUlNcbiAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctQ3JlZGVudGlhbHMnLCAndHJ1ZScpO1xuICByZXMuc2V0SGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nLCAnKicpO1xuICByZXMuc2V0SGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJywgJ0dFVCxPUFRJT05TLFBBVENILERFTEVURSxQT1NULFBVVCcpO1xuICByZXMuc2V0SGVhZGVyKFxuICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJyxcbiAgICAnWC1DU1JGLVRva2VuLCBYLVJlcXVlc3RlZC1XaXRoLCBBY2NlcHQsIEFjY2VwdC1WZXJzaW9uLCBDb250ZW50LUxlbmd0aCwgQ29udGVudC1NRDUsIENvbnRlbnQtVHlwZSwgRGF0ZSwgWC1BcGktVmVyc2lvbidcbiAgKTtcblxuICBpZiAocmVxLm1ldGhvZCA9PT0gJ09QVElPTlMnKSB7XG4gICAgcmVzLnN0YXR1cygyMDApLmVuZCgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBtZXNzYWdlOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyBzZWFyY2hVcmwgfSA9IHJlcS5ib2R5O1xuICAgIGNvbnNvbGUubG9nKCdSZWNlaXZlZCBzZWFyY2ggVVJMOicsIHNlYXJjaFVybCk7XG4gICAgXG4gICAgaWYgKCFzZWFyY2hVcmwpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICdTZWFyY2ggVVJMIGlzIHJlcXVpcmVkJyB9KTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBVUkwgZm9ybWF0XG4gICAgdHJ5IHtcbiAgICAgIG5ldyBVUkwoc2VhcmNoVXJsKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ0ludmFsaWQgVVJMIGZvcm1hdCcgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIERldGVybWluZSB3aGljaCBwYXJzZXIgdG8gdXNlXG4gICAgbGV0IHBhcnNlcjogUHJvcGVydHlQYXJzZXIgfCB1bmRlZmluZWQ7XG4gICAgbGV0IHBhcnNlck5hbWUgPSAnJztcblxuICAgIGlmIChSSUdIVE1PVkVfU0VBUkNIX1VSTF9QQVRURVJOLnRlc3Qoc2VhcmNoVXJsKSkge1xuICAgICAgcGFyc2VyID0gUEFSU0VSUy5yaWdodG1vdmU7XG4gICAgICBwYXJzZXJOYW1lID0gJ3JpZ2h0bW92ZSc7XG4gICAgfSBlbHNlIGlmIChaT09QTEFfU0VBUkNIX1VSTF9QQVRURVJOLnRlc3Qoc2VhcmNoVXJsKSkge1xuICAgICAgcGFyc2VyID0gUEFSU0VSUy56b29wbGE7XG4gICAgICBwYXJzZXJOYW1lID0gJ3pvb3BsYSc7XG4gICAgfSBlbHNlIGlmIChPUEVOUkVOVF9TRUFSQ0hfVVJMX1BBVFRFUk4udGVzdChzZWFyY2hVcmwpKSB7XG4gICAgICBwYXJzZXIgPSBQQVJTRVJTLm9wZW5yZW50O1xuICAgICAgcGFyc2VyTmFtZSA9ICdvcGVucmVudCc7XG4gICAgfVxuXG4gICAgaWYgKCFwYXJzZXIpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdVUkwgcGF0dGVybiBtYXRjaGluZyByZXN1bHRzOicsIHtcbiAgICAgICAgcmlnaHRtb3ZlOiBSSUdIVE1PVkVfU0VBUkNIX1VSTF9QQVRURVJOLnRlc3Qoc2VhcmNoVXJsKSxcbiAgICAgICAgem9vcGxhOiBaT09QTEFfU0VBUkNIX1VSTF9QQVRURVJOLnRlc3Qoc2VhcmNoVXJsKSxcbiAgICAgICAgb3BlbnJlbnQ6IE9QRU5SRU5UX1NFQVJDSF9VUkxfUEFUVEVSTi50ZXN0KHNlYXJjaFVybClcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIHByb3BlcnR5IHNlYXJjaCBVUkwgZm9ybWF0LiBPbmx5IFJpZ2h0bW92ZSwgWm9vcGxhLCBhbmQgT3BlblJlbnQgVVJMcyBhcmUgc3VwcG9ydGVkLicgXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgVXNpbmcgJHtwYXJzZXJOYW1lfSBwYXJzZXIgZm9yIFVSTDpgLCBzZWFyY2hVcmwpO1xuXG4gICAgY29uc3QgaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE1XzcpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjIuMC4wLjAgU2FmYXJpLzUzNy4zNicsXG4gICAgICAnQWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCcsXG4gICAgICAnQWNjZXB0LUxhbmd1YWdlJzogJ2VuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44JyxcbiAgICAgICdBY2NlcHQtRW5jb2RpbmcnOiAnZ3ppcCwgZGVmbGF0ZSwgYnInLFxuICAgICAgJ0NhY2hlLUNvbnRyb2wnOiAnbm8tY2FjaGUnLFxuICAgICAgJ1ByYWdtYSc6ICduby1jYWNoZScsXG4gICAgICAnU2VjLUNoLVVhJzogJ1wiQ2hyb21pdW1cIjt2PVwiMTIyXCIsIFwiTm90KEE6QnJhbmRcIjt2PVwiMjRcIiwgXCJHb29nbGUgQ2hyb21lXCI7dj1cIjEyMlwiJyxcbiAgICAgICdTZWMtQ2gtVWEtTW9iaWxlJzogJz8wJyxcbiAgICAgICdTZWMtQ2gtVWEtUGxhdGZvcm0nOiAnXCJtYWNPU1wiJyxcbiAgICAgICdTZWMtRmV0Y2gtRGVzdCc6ICdkb2N1bWVudCcsXG4gICAgICAnU2VjLUZldGNoLU1vZGUnOiAnbmF2aWdhdGUnLFxuICAgICAgJ1NlYy1GZXRjaC1TaXRlJzogJ25vbmUnLFxuICAgICAgJ1NlYy1GZXRjaC1Vc2VyJzogJz8xJyxcbiAgICAgICdVcGdyYWRlLUluc2VjdXJlLVJlcXVlc3RzJzogJzEnLFxuICAgICAgJ0Nvbm5lY3Rpb24nOiAna2VlcC1hbGl2ZSdcbiAgICB9O1xuXG4gICAgLy8gQWRkIHNpdGUtc3BlY2lmaWMgaGVhZGVyc1xuICAgIGlmIChwYXJzZXJOYW1lID09PSAncmlnaHRtb3ZlJykge1xuICAgICAgaGVhZGVyc1snUmVmZXJlciddID0gJ2h0dHBzOi8vd3d3LnJpZ2h0bW92ZS5jby51ay8nO1xuICAgIH0gZWxzZSBpZiAocGFyc2VyTmFtZSA9PT0gJ3pvb3BsYScpIHtcbiAgICAgIGhlYWRlcnNbJ1JlZmVyZXInXSA9ICdodHRwczovL3d3dy56b29wbGEuY28udWsvJztcbiAgICB9IGVsc2UgaWYgKHBhcnNlck5hbWUgPT09ICdvcGVucmVudCcpIHtcbiAgICAgIGhlYWRlcnNbJ1JlZmVyZXInXSA9ICdodHRwczovL3d3dy5vcGVucmVudC5jby51ay8nO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goc2VhcmNoVXJsLCB7IGhlYWRlcnMgfSk7XG5cbiAgICBjb25zb2xlLmxvZygnRmV0Y2ggcmVzcG9uc2Ugc3RhdHVzOicsIHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgY29uc29sZS5sb2coJ0ZldGNoIHJlc3BvbnNlIGhlYWRlcnM6JywgcmVzcG9uc2UuaGVhZGVycyk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignQWNjZXNzIGZvcmJpZGRlbiAtIHBvc3NpYmxlIGJvdCBkZXRlY3Rpb24nKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgXG4gICAgICAgICAgbWVzc2FnZTogJ1VuYWJsZSB0byBhY2Nlc3MgdGhlIHByb3BlcnR5IHNpdGUuIFRoaXMgbWlnaHQgYmUgZHVlIHRvIHJhdGUgbGltaXRpbmcgb3IgYm90IGRldGVjdGlvbi4nIFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdQYWdlIG5vdCBmb3VuZCcpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBcbiAgICAgICAgICBtZXNzYWdlOiAnVGhlIHByb3BlcnR5IGxpc3RpbmcgcGFnZSBjb3VsZCBub3QgYmUgZm91bmQuIFRoZSBVUkwgbWlnaHQgYmUgaW52YWxpZCBvciB0aGUgbGlzdGluZyBtYXkgaGF2ZSBiZWVuIHJlbW92ZWQuJyBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZmV0Y2g6JywgcmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5zdGF0dXNUZXh0KTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIHNlYXJjaCByZXN1bHRzOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgIH1cblxuICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgY29uc29sZS5sb2coJ0hUTUwgcmVjZWl2ZWQsIGxlbmd0aDonLCBodG1sLmxlbmd0aCk7XG4gICAgXG4gICAgaWYgKGh0bWwubGVuZ3RoIDwgMTAwMCkge1xuICAgICAgY29uc29sZS53YXJuKCdTdXNwaWNpb3VzbHkgc2hvcnQgSFRNTCByZXNwb25zZTonLCBodG1sKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7IFxuICAgICAgICBtZXNzYWdlOiAnUmVjZWl2ZWQgYW4gaW52YWxpZCByZXNwb25zZSBmcm9tIHRoZSBwcm9wZXJ0eSBzaXRlLiBUaGlzIG1pZ2h0IGJlIGR1ZSB0byByYXRlIGxpbWl0aW5nIG9yIGJvdCBkZXRlY3Rpb24uJyBcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdGaXJzdCA1MDAgY2hhcnMgb2YgSFRNTDonLCBodG1sLnN1YnN0cmluZygwLCA1MDApKTtcbiAgICBcbiAgICBjb25zdCAkID0gY2hlZXJpby5sb2FkKGh0bWwpO1xuICAgIGNvbnN0IHByb3BlcnRpZXM6IFByb3BlcnR5W10gPSBbXTtcbiAgICBcbiAgICAvLyBHZXQgZmlyc3QgMyByZWd1bGFyIGxpc3RpbmdzXG4gICAgY29uc3QgbGlzdGluZ3MgPSAkKHBhcnNlci5zZWxlY3Rvcik7XG4gICAgY29uc29sZS5sb2coYEZvdW5kICR7bGlzdGluZ3MubGVuZ3RofSBsaXN0aW5ncyB3aXRoIHNlbGVjdG9yIFwiJHtwYXJzZXIuc2VsZWN0b3J9XCJgKTtcbiAgICBcbiAgICBpZiAobGlzdGluZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyBMb2cgYSBzYW1wbGUgb2YgdGhlIEhUTUwgc3RydWN0dXJlIHRvIGhlbHAgZGVidWcgc2VsZWN0b3IgaXNzdWVzXG4gICAgICBjb25zb2xlLmxvZygnSFRNTCBzdHJ1Y3R1cmUgc2FtcGxlOicpO1xuICAgICAgJCgnYm9keScpLmNoaWxkcmVuKCkuc2xpY2UoMCwgMykuZWFjaCgoXywgZWwpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJChlbCkucHJvcCgndGFnTmFtZScpLCAkKGVsKS5hdHRyKCdjbGFzcycpIHx8ICduby1jbGFzcycpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiAnTm8gcHJvcGVydHkgbGlzdGluZ3MgZm91bmQnIH0pO1xuICAgIH1cblxuICAgIGxpc3RpbmdzLmVhY2goKGluZGV4OiBudW1iZXIsIGVsZW1lbnQ6IGNoZWVyaW8uRWxlbWVudCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvcGVydHkgPSBwYXJzZXIuZXh0cmFjdCgkLCBlbGVtZW50KTtcbiAgICAgICAgaWYgKHByb3BlcnR5KSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFN1Y2Nlc3NmdWxseSBleHRyYWN0ZWQgcHJvcGVydHkgJHtpbmRleCArIDF9OmAsIHtcbiAgICAgICAgICAgIHRpdGxlOiBwcm9wZXJ0eS50aXRsZSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9wZXJ0eS5wcmljZSxcbiAgICAgICAgICAgIGxvY2F0aW9uOiBwcm9wZXJ0eS5sb2NhdGlvbixcbiAgICAgICAgICAgIHNwZWNzOiBwcm9wZXJ0eS5zcGVjc1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYEZhaWxlZCB0byBleHRyYWN0IHByb3BlcnR5ICR7aW5kZXggKyAxfSAtIG1pc3NpbmcgcmVxdWlyZWQgZmllbGRzYCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGV4dHJhY3RpbmcgcHJvcGVydHkgJHtpbmRleCArIDF9OmAsIGVycm9yKTtcbiAgICAgIH1cbiAgICAgIGlmIChwcm9wZXJ0aWVzLmxlbmd0aCA+PSAzKSByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG5cbiAgICBpZiAocHJvcGVydGllcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdObyB2YWxpZCBwcm9wZXJ0aWVzIGZvdW5kJyk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiAnTm8gdmFsaWQgcHJvcGVydHkgZGF0YSBjb3VsZCBiZSBleHRyYWN0ZWQnIH0pO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdSZXR1cm5pbmcgcHJvcGVydGllczonLCBwcm9wZXJ0aWVzLmxlbmd0aCk7XG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvcGVydGllcyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBwcm9wZXJ0eSBzZWFyY2g6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiAnRXJyb3IgcHJvY2Vzc2luZyBwcm9wZXJ0eSBzZWFyY2gnLFxuICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZSBcbiAgICB9KTtcbiAgfVxufSAiXSwibmFtZXMiOlsiY2hlZXJpbyIsIlJJR0hUTU9WRV9TRUFSQ0hfVVJMX1BBVFRFUk4iLCJaT09QTEFfU0VBUkNIX1VSTF9QQVRURVJOIiwiT1BFTlJFTlRfU0VBUkNIX1VSTF9QQVRURVJOIiwiUEFSU0VSUyIsInJpZ2h0bW92ZSIsInNlbGVjdG9yIiwiYmFzZVVybCIsImV4dHJhY3QiLCIkIiwiZWxlbWVudCIsIiRlbGVtZW50IiwicHJpY2UiLCJmaW5kIiwidGV4dCIsInRyaW0iLCJ0aXRsZSIsImxvY2F0aW9uIiwiaW1hZ2UiLCJhdHRyIiwicHJvcGVydHlVcmwiLCJzcGVjcyIsImJlZHMiLCJwYXJzZUludCIsImJhdGhzIiwiYXJlYSIsImlkIiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJzdGFydHNXaXRoIiwidW5kZWZpbmVkIiwiem9vcGxhIiwiZmlyc3QiLCJvcGVucmVudCIsInRpdGxlRWxlbWVudCIsInNwbGl0IiwiZGVzY3JpcHRpb24iLCJiZWRzTWF0Y2giLCJtYXRjaCIsImJhdGhzTWF0Y2giLCJoYW5kbGVyIiwicmVxIiwicmVzIiwic2V0SGVhZGVyIiwibWV0aG9kIiwic3RhdHVzIiwiZW5kIiwianNvbiIsIm1lc3NhZ2UiLCJzZWFyY2hVcmwiLCJib2R5IiwiY29uc29sZSIsImxvZyIsIlVSTCIsImVycm9yIiwicGFyc2VyIiwicGFyc2VyTmFtZSIsInRlc3QiLCJoZWFkZXJzIiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwic3RhdHVzVGV4dCIsIkVycm9yIiwiaHRtbCIsImxlbmd0aCIsIndhcm4iLCJzdWJzdHJpbmciLCJsb2FkIiwicHJvcGVydGllcyIsImxpc3RpbmdzIiwiY2hpbGRyZW4iLCJzbGljZSIsImVhY2giLCJfIiwiZWwiLCJwcm9wIiwiaW5kZXgiLCJwcm9wZXJ0eSIsInB1c2giXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/properties/search-listings.ts\n");

/***/ }),

/***/ "cheerio":
/*!**************************!*\
  !*** external "cheerio" ***!
  \**************************/
/***/ ((module) => {

module.exports = import("cheerio");;

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproperties%2Fsearch-listings&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fproperties%2Fsearch-listings.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();